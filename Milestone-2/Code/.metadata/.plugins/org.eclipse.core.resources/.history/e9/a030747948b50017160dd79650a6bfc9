import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;

class DBHandler{

	protected static final String jdbcUrl = "jdbc:oracle:thin:@orca.csc.ncsu.edu:1521:orcl01";
	private Connection conn;
	private final String userName, password;

	private static DBHandler dbHandler;
	
	private DBHandler(){
		// Singleton
		userName = "gverma";
		password = "200158973";
	}
	
	public static DBHandler getDBHandler(){
		if(dbHandler == null){
			dbHandler = new DBHandler();
		}
		return dbHandler;
	}

	public boolean createConnection() throws SQLException{
		if (jdbcUrl == null){
			throw new SQLException("JDBC URL can not be null!", "08001");
		}
		if (conn == null){
			try{
				conn = (Connection) DriverManager.getConnection(jdbcUrl, userName, password);
			}catch(SQLException sqlExcpt){
				throw sqlExcpt;
			}
		}
		return true;
	}
	
	public LoginDetails login(String userName, String password){		
		return new LoginDetails("Gautam", "Verma", "200158973", (short)1);
	}

	protected void closeConnection(){
		if(conn != null) {
			try {
				conn.close();
			} catch(Throwable whatever) {}
		}
	}

	protected void closeStatement(Statement st){
		if(st != null) {
			try {
				st.close();
			} catch(Throwable whatever) {}
		}
	}

	protected void closeResultSet(ResultSet rs){
		if(rs != null) {
			try {
				rs.close();
			} catch(Throwable whatever) {}
		}
	}
	
	public String[] getProfOrTADetails(){
		return new String[]{"Gautam", "Verma", "200158973"};
	}
	
	public String[][] getTaughtCoursesByProfessor(int profId){
		return new String[][]{new String[]{"ALGO", "CSC-505"}, new String[]{"SE", "CSC-510"}};
	}
}

class LoginDetails{
	private String personFirstName, personLastName, id;
	private short personType;
	
	public LoginDetails(String fName, String lName, String id, short personType) {
		// TODO Auto-generated constructor stub
		personFirstName = fName;
		personLastName  = lName;
		this.id = id;
		this.personType = personType;
	}
	
	public String getFirstName(){
		return personFirstName;
	}
	
	public String getLastName(){
		return personLastName;
	}
	
	public String getId(){
		return id;
	}
	
	public short getPersonType(){
		return personType;
	}
}
